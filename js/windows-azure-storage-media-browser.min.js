window.wp=window.wp||{},function(d,l,p){d(document).ready(function(){var t=wp.media;if(void 0!==t){var e=t.view.MediaFrame.Manage,i=t.view.AttachmentsBrowser,n=t.view.Toolbar,o=t.view.Attachments,a=p.clone(t.model.Query.prototype),r=p.clone(t.model.Attachment.prototype);t.view.Attachment.Details=t.view.Attachment.Details.extend({deleteAttachment:function(e){e.preventDefault(),l.confirm(t.view.l10n.warnDelete)&&this.model.destroy()}}),p.extend(t.model.Attachment.prototype,{sync:function(e,t,i){return p.isUndefined(this.id)?d.Deferred().rejectWith(this).promise():"delete"===e?((i=i||{}).context=this,i.data=p.extend(i.data||{},{action:"delete-azure-blob",id:this.id,_wpnonce:this.get("nonces").delete}),wp.media.ajax(i).done(function(){this.destroyed=!0}).fail(function(){this.destroyed=!1})):r.sync.apply(this,arguments)},destroy:function(e){return(e=e||{}).wait=!0,r.destroy.apply(this,[e])}}),p.extend(t.model.Query.prototype,{sync:function(e,t,i){var n;return"read"===e?((i=i||{}).context=this,i.data=p.extend(i.data||{},{action:"query-azure-attachments"}),-1!==(n=p.clone(this.args)).posts_per_page&&(n.paged=Math.round(this.length/n.posts_per_page)+1),i.data.query=n,wp.media.ajax(i)):a.sync.apply(this,arguments)}}),t.view.Attachments=t.view.Attachments.extend({initialize:function(){this.options.refreshThreshold=3,o.prototype.initialize.apply(this,arguments)}}),t.view.AttachmentsBrowser=t.view.AttachmentsBrowser.extend({initialize:function(){this.options.sidebar=!0,this.options.scrollElement=void 0,i.prototype.initialize.apply(this,arguments)}}),t.view.MediaFrame.Manage=t.view.MediaFrame.Manage.extend({initialize:function(){this.options.uploader=!1,this.options.mode=["grid"],this.options.multiple=!1,e.prototype.initialize.apply(this,arguments)},bindRegionModeHandlers:function(){e.prototype.bindRegionModeHandlers.apply(this,arguments),this.on("toolbar:create",this.createSelectToolbar,this)},createSelectToolbar:function(e,t){(t=t||this.options.button||{}).controller=this,t.text=_wpMediaGridSettings.l10n.selectText,e.view=new wp.media.view.Toolbar.Select(t)}}),t.view.Toolbar=t.view.Toolbar.extend({set:function(e,t,i){return p.contains(["filters","libraryViewSwitcher","dateFilterLabel","dateFilter","selectModeToggleButton","deleteSelectedButton"],e)?void 0:n.prototype.set.apply(this,arguments)}});var s=t({frame:"manage",container:d("#windows-azure-storage-browser"),library:{}}).open();s.on("select",function(){var e=s.state().get("selection").first().toJSON();l.parent.wp.azureFrame.trigger("azure:selected",e)})}})}(jQuery,window,_);