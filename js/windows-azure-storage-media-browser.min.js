window.wp=window.wp||{},function(a,b,c){a(document).ready(function(){var d=wp.media;if(void 0!==d){var e=d.view.MediaFrame.Manage,f=d.view.AttachmentsBrowser,g=d.view.Toolbar,h=d.view.Attachments,i=c.clone(d.model.Query.prototype),j=c.clone(d.model.Attachment.prototype);d.view.Attachment.Details=d.view.Attachment.Details.extend({deleteAttachment:function(a){a.preventDefault(),b.confirm(d.view.l10n.warnDelete)&&this.model.destroy()}}),c.extend(d.model.Attachment.prototype,{sync:function(b,d,e){return c.isUndefined(this.id)?a.Deferred().rejectWith(this).promise():"delete"===b?(e=e||{},e.context=this,e.data=c.extend(e.data||{},{action:"delete-azure-blob",id:this.id,_wpnonce:this.get("nonces").delete}),wp.media.ajax(e).done(function(){this.destroyed=!0}).fail(function(){this.destroyed=!1})):j.sync.apply(this,arguments)},destroy:function(a){return a=a||{},a.wait=!0,j.destroy.apply(this,[a])}}),c.extend(d.model.Query.prototype,{sync:function(a,b,d){var e;return"read"===a?(d=d||{},d.context=this,d.data=c.extend(d.data||{},{action:"query-azure-attachments"}),e=c.clone(this.args),-1!==e.posts_per_page&&(e.paged=Math.round(this.length/e.posts_per_page)+1),d.data.query=e,wp.media.ajax(d)):i.sync.apply(this,arguments)}}),d.view.Attachments=d.view.Attachments.extend({initialize:function(){this.options.refreshThreshold=3,h.prototype.initialize.apply(this,arguments)}}),d.view.AttachmentsBrowser=d.view.AttachmentsBrowser.extend({initialize:function(){this.options.sidebar=!0,this.options.scrollElement=void 0,f.prototype.initialize.apply(this,arguments)}}),d.view.MediaFrame.Manage=d.view.MediaFrame.Manage.extend({initialize:function(){this.options.uploader=!1,this.options.mode=["grid"],this.options.multiple=!1,e.prototype.initialize.apply(this,arguments)},bindRegionModeHandlers:function(){e.prototype.bindRegionModeHandlers.apply(this,arguments),this.on("toolbar:create",this.createSelectToolbar,this)},createSelectToolbar:function(a,b){b=b||this.options.button||{},b.controller=this,b.text=_wpMediaGridSettings.l10n.selectText,a.view=new wp.media.view.Toolbar.Select(b)}}),d.view.Toolbar=d.view.Toolbar.extend({set:function(a,b,d){return c.contains(["filters","libraryViewSwitcher","dateFilterLabel","dateFilter","selectModeToggleButton","deleteSelectedButton"],a)?void 0:g.prototype.set.apply(this,arguments)}});var k=d({frame:"manage",container:a("#windows-azure-storage-browser"),library:{}}).open();k.on("select",function(){var a=k.state().get("selection").first().toJSON();b.parent.wp.azureFrame.trigger("azure:selected",a)})}})}(jQuery,window,_);