window.wp=window.wp||{},function(e,t,i){e(document).ready(function(){var n=wp.media;if(void 0!==n){var o=n.view.MediaFrame.Manage,a=n.view.AttachmentsBrowser,r=n.view.Toolbar,s=n.view.Attachments,d=i.clone(n.model.Query.prototype),l=i.clone(n.model.Attachment.prototype);n.view.Attachment.Details=n.view.Attachment.Details.extend({deleteAttachment:function(e){e.preventDefault(),t.confirm(n.view.l10n.warnDelete)&&this.model.destroy()}}),i.extend(n.model.Attachment.prototype,{sync:function(t,n,o){return i.isUndefined(this.id)?e.Deferred().rejectWith(this).promise():"delete"===t?((o=o||{}).context=this,o.data=i.extend(o.data||{},{action:"delete-azure-blob",id:this.id,_wpnonce:this.get("nonces").delete}),wp.media.ajax(o).done(function(){this.destroyed=!0}).fail(function(){this.destroyed=!1})):l.sync.apply(this,arguments)},destroy:function(e){return(e=e||{}).wait=!0,l.destroy.apply(this,[e])}}),i.extend(n.model.Query.prototype,{sync:function(e,t,n){var o;return"read"===e?((n=n||{}).context=this,n.data=i.extend(n.data||{},{action:"query-azure-attachments"}),-1!==(o=i.clone(this.args)).posts_per_page&&(o.paged=Math.round(this.length/o.posts_per_page)+1),n.data.query=o,wp.media.ajax(n)):d.sync.apply(this,arguments)}}),n.view.Attachments=n.view.Attachments.extend({initialize:function(){this.options.refreshThreshold=3,s.prototype.initialize.apply(this,arguments)}}),n.view.AttachmentsBrowser=n.view.AttachmentsBrowser.extend({initialize:function(){this.options.sidebar=!0,this.options.scrollElement=void 0,a.prototype.initialize.apply(this,arguments)}}),n.view.MediaFrame.Manage=n.view.MediaFrame.Manage.extend({initialize:function(){this.options.uploader=!1,this.options.mode=["grid"],this.options.multiple=!1,o.prototype.initialize.apply(this,arguments)},bindRegionModeHandlers:function(){o.prototype.bindRegionModeHandlers.apply(this,arguments),this.on("toolbar:create",this.createSelectToolbar,this)},createSelectToolbar:function(e,t){(t=t||this.options.button||{}).controller=this,t.text=_wpMediaGridSettings.l10n.selectText,e.view=new wp.media.view.Toolbar.Select(t)}}),n.view.Toolbar=n.view.Toolbar.extend({set:function(e,t,n){return i.contains(["filters","libraryViewSwitcher","dateFilterLabel","dateFilter","selectModeToggleButton","deleteSelectedButton"],e)?void 0:r.prototype.set.apply(this,arguments)}});var p=n({frame:"manage",container:e("#windows-azure-storage-browser"),library:{}}).open();p.on("select",function(){var e=p.state().get("selection").first().toJSON();t.parent.wp.azureFrame.trigger("azure:selected",e)})}})}(jQuery,window,_);